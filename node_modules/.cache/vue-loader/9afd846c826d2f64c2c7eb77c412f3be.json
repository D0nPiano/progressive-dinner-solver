{"remainingRequest":"/home/donpiano/running-dinner-solver/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/donpiano/running-dinner-solver/src/components/Emails.vue?vue&type=style&index=0&id=3ba3cb07&scoped=true&lang=css&","dependencies":[{"path":"/home/donpiano/running-dinner-solver/src/components/Emails.vue","mtime":1575238387996},{"path":"/home/donpiano/running-dinner-solver/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/donpiano/running-dinner-solver/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/donpiano/running-dinner-solver/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/donpiano/running-dinner-solver/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/donpiano/running-dinner-solver/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5idXR0b24gewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKfQo="},{"version":3,"sources":["Emails.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwLA;AACA;AACA","file":"Emails.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"page\">\n    <h1>Emails</h1>\n    <p\n      class=\"alert alert-info\"\n    >Here, all neccesarry information will be added to a new csv file. After creating the email, you can download it and use it with \"Mail Merge\" in Thunderbird to automatically write all E-Mails.</p>\n    <div style=\"max-width: 50em; margin: auto\">\n      <download-csv\n        class=\"button\"\n        :data=\"csv\">\n         <button class=\"btn btn-primary\">Backup your created Teams</button>\n      </download-csv>\n      <button class=\"btn btn-primary\" type=\"button\" v-if=\"!emails_created\" @click=\"createEmails\">Create E-Mails</button>\n      <download-csv\n        class=\"button\"\n        v-if=\"emails_created\"\n        :data=\"emails\">\n         <button class=\"btn btn-primary\">Download Data for Emails</button>\n      </download-csv>\n    </div>\n    <div id=\"people\">\n      <v-client-table\n        v-if=\"csv.length > 2\"\n        :data=\"csv\"\n        :columns=\"mapFields\"\n      >\n        <template slot=\"submit\" slot-scope=\"{submit}\">\n          <button @click.prevent=\"submit\">send!</button>\n        </template>\n      </v-client-table>\n    </div>\n    <span v-html=\"filledEmailTemplate\"></span>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Emails',\n  data: function() {\n    return {\n      csv: [],\n      emails: [],\n      emails_created: false,\n      filledEmailTemplate: null,\n      mapFields: [\"firstname\", \"lastname\", \"organization\", \"email\"],\n    };\n  },\n  methods: {\n    createEmails() {\n      this.emails = []\n      this.csv.forEach(e => {\n        let emailInfo = {}\n        let teamPartner = this.getTeamPartner(e)\n        let firstCoursePerson = this.getPersonWithTeamId(e.firstCourse)\n        let secondCoursePerson = this.getPersonWithTeamId(e.secondCourse)\n        let thirdCoursePerson = this.getPersonWithTeamId(e.thirdCourse)\n\n        emailInfo.firstname = e.firstname\n        emailInfo.email = e.email\n        emailInfo.teamId = e.teamId\n        emailInfo.teamCourse = this.getCourseName(e.teamId)\n\n        // Team Partner Info\n        emailInfo.teamPartnerFirstname = teamPartner.firstname\n        emailInfo.teamPartnerLastname = teamPartner.lastname\n        emailInfo.teamPartnerEmail = teamPartner.email\n        emailInfo.teamPartnerOrganization = teamPartner.organization\n\n        let tel = teamPartner.phone.toString()\n        if (tel[0] != \"0\" && tel[0] != \"+\" && tel[0] != \"4\") {\n          tel = \"0\" + tel\n        }\n        if (tel[0] == \"4\" && tel[1] == \"9\"){\n          tel = \"+\" + tel\n        }\n        emailInfo.teamPartnerPhone = tel\n\n        // First Course Info\n        emailInfo.firstCoursePersonFirstname = firstCoursePerson.firstname\n        emailInfo.firstCoursePersonLastname = firstCoursePerson.lastname\n        emailInfo.firstCoursePersonOrganization = firstCoursePerson.organization\n        emailInfo.firstCoursePersonArea = firstCoursePerson.area\n        emailInfo.firstCoursePersonStreet = firstCoursePerson.street\n        emailInfo.firstCoursePersonSteetnumber = firstCoursePerson.streetnumber\n        emailInfo.firstCoursePersonZip = firstCoursePerson.zip\n\n\n        // Second Course Info\n        emailInfo.secondCoursePersonFirstname = secondCoursePerson.firstname\n        emailInfo.secondCoursePersonLastname = secondCoursePerson.lastname\n        emailInfo.secondCoursePersonOrganization = secondCoursePerson.organization\n        emailInfo.secondCoursePersonArea = secondCoursePerson.area\n        emailInfo.secondCoursePersonStreet = secondCoursePerson.street\n        emailInfo.secondCoursePersonSteetnumber = secondCoursePerson.streetnumber\n        emailInfo.secondCoursePersonZip = secondCoursePerson.zip\n\n        // Third Course Info\n        emailInfo.thirdCoursePersonFirstname = thirdCoursePerson.firstname\n        emailInfo.thirdCoursePersonLastname = thirdCoursePerson.lastname\n        emailInfo.thirdCoursePersonOrganization = thirdCoursePerson.organization\n        emailInfo.thirdCoursePersonArea = thirdCoursePerson.area\n        emailInfo.thirdCoursePersonStreet = thirdCoursePerson.street\n        emailInfo.thirdCoursePersonSteetnumber = thirdCoursePerson.streetnumber\n        emailInfo.thirdCoursePersonZip = thirdCoursePerson.zip\n\n        this.emails.push(emailInfo)\n\n/*\n        let template = Guddi_Einteilung\n        template = template.replace(/%%%Vorname%%%/gi, e.firstname)\n        template = template.replace(/%%%Team_Course%%%/gi, this.getCourseName(e.teamId))\n        //console.log('partner', e.firstname, teamPartner.firstname) // eslint-disable-line\n        template = template.replace(/%%%Teampartner_Vorname%%%/gi, teamPartner.firstname)\n        template = template.replace(/%%%Teampartner_Nachname%%%/gi, teamPartner.lastname)\n        template = template.replace(/%%%Teampartner_Email%%%/gi, teamPartner.email)\n        template = template.replace(/%%%Teampartner_Organisation%%%/gi, teamPartner.organization)\n        template = template.replace(/%%%Teampartner_Telefon%%%/gi, emailInfo.teamPartnerPhone)\n\n        template = template.replace(/%%%FirstCourse_Vorname%%%/gi, firstCoursePerson.firstname)\n        template = template.replace(/%%%FirstCourse_Nachname%%%/gi, firstCoursePerson.lastname)\n        template = template.replace(/%%%FirstCourse_Organisation%%%/gi, firstCoursePerson.organization)\n        template = template.replace(/%%%FirstCourse_Viertel%%%/gi, firstCoursePerson.area)\n        template = template.replace(/%%%FirstCourse_Street%%%/gi, firstCoursePerson.street)\n        template = template.replace(/%%%FirstCourse_Streetnumber%%%/gi, firstCoursePerson.streetnumber)\n        template = template.replace(/%%%FirstCourse_PLZ%%%/gi, firstCoursePerson.zip)\n\n        template = template.replace(/%%%SecondCourse_Vorname%%%/gi, secondCoursePerson.firstname)\n        template = template.replace(/%%%SecondCourse_Nachname%%%/gi, secondCoursePerson.lastname)\n        template = template.replace(/%%%SecondCourse_Organisation%%%/gi, secondCoursePerson.organization)\n        template = template.replace(/%%%SecondCourse_Viertel%%%/gi, secondCoursePerson.area)\n        template = template.replace(/%%%SecondCourse_Street%%%/gi, secondCoursePerson.street)\n        template = template.replace(/%%%SecondCourse_Streetnumber%%%/gi, secondCoursePerson.streetnumber)\n        template = template.replace(/%%%SecondCourse_PLZ%%%/gi, secondCoursePerson.zip)\n\n        template = template.replace(/%%%ThirdCourse_Vorname%%%/gi, thirdCoursePerson.firstname)\n        template = template.replace(/%%%ThirdCourse_Nachname%%%/gi, thirdCoursePerson.lastname)\n        template = template.replace(/%%%ThirdCourse_Organisation%%%/gi, thirdCoursePerson.organization)\n        template = template.replace(/%%%ThirdCourse_Viertel%%%/gi, thirdCoursePerson.area)\n        template = template.replace(/%%%ThirdCourse_Street%%%/gi, thirdCoursePerson.street)\n        template = template.replace(/%%%ThirdCourse_Streetnumber%%%/gi, thirdCoursePerson.streetnumber)\n        template = template.replace(/%%%ThirdCourse_PLZ%%%/gi, thirdCoursePerson.zip)\n        this.filledEmailTemplate = template\n        e.generated_mail = template\n        */\n      });\n      this.emails_created = true\n    },\n    getCourseName(teamid) { // TODO: should be agnostic from number of teams\n      if (teamid < 8) {\n        return \"Vorspeise\"\n      } else if (teamid >= 8 && teamid < 15) {\n        return \"Hauptspeise\"\n      } else {\n        return \"Nachspeise\"\n      }\n    },\n    getTeamPartner(person){\n      let partner = null\n      this.csv.forEach(e => {\n        if (e.teamId == person.teamId && e.kitchenUsed != person.kitchenUsed){\n          partner = e\n        }\n      })\n      return partner\n    },\n    getPersonWithTeamId(teamId){\n      let partner = null\n      this.csv.forEach(e => {\n        if (e.teamId == teamId && e.kitchenUsed == \"Ja\"){\n          partner = e\n        }\n      })\n      return partner\n    }\n  },\n  mounted: function() {\n    if (this.$store.state.csv) {\n      this.csv = this.$store.state.csv;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.button {\n  display: inline-block;\n}\n</style>\n"]}]}